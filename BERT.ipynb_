{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1Dx_IiYdapGCspq65k5HX942EeH-SF_rj","timestamp":1744389172417}],"gpuType":"T4","authorship_tag":"ABX9TyOgvsYdQteW9XlEEItaV+Gy"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"6a8285b2da7649a996140a2a8513c742":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_15fed065a0c24116a959ebdd9b16e755","IPY_MODEL_219825d73e0e48c0897c8f6b66d03a30","IPY_MODEL_6ebdf1784e03417b93437e200df65cdb"],"layout":"IPY_MODEL_71d160cfa40c461e8a5f3f6f64bdea74"}},"15fed065a0c24116a959ebdd9b16e755":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_29a0d99712b64291aab997cc22e72786","placeholder":"​","style":"IPY_MODEL_07b3960695224d29bea0c71533b226b7","value":"config.json: 100%"}},"219825d73e0e48c0897c8f6b66d03a30":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_71eb9c44059548889ccf6e7b2772cc05","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bf75bbe5eb764fa4a3338d695af4e229","value":570}},"6ebdf1784e03417b93437e200df65cdb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_91db10e7d2f84595acca2f03b6d13f32","placeholder":"​","style":"IPY_MODEL_5276748d5ada45dabc8cfea5757cdc77","value":" 570/570 [00:00&lt;00:00, 15.4kB/s]"}},"71d160cfa40c461e8a5f3f6f64bdea74":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"29a0d99712b64291aab997cc22e72786":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"07b3960695224d29bea0c71533b226b7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"71eb9c44059548889ccf6e7b2772cc05":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bf75bbe5eb764fa4a3338d695af4e229":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"91db10e7d2f84595acca2f03b6d13f32":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5276748d5ada45dabc8cfea5757cdc77":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"903851f6f363442fbfeb8168be8770fb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_48c4e03b1c2147c58bebe4ed9ee43f6c","IPY_MODEL_0f8e8eb0e6b548dab6e51dcc7ad79b17","IPY_MODEL_7fc0ff81485741299593725757a4a3ee"],"layout":"IPY_MODEL_e5fa02b1a81f4d9f89272c8525123d6b"}},"48c4e03b1c2147c58bebe4ed9ee43f6c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d53ffceb65424876895385320663e88b","placeholder":"​","style":"IPY_MODEL_5780f994c4474aa3b06c17e419d208d7","value":"model.safetensors: 100%"}},"0f8e8eb0e6b548dab6e51dcc7ad79b17":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_43b8daaf33b94117a4354d6c0a4b5f6b","max":440449768,"min":0,"orientation":"horizontal","style":"IPY_MODEL_56044075635844c2a0b93f687b84f96a","value":440449768}},"7fc0ff81485741299593725757a4a3ee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2710e0d776734079b0cf828cfbda942e","placeholder":"​","style":"IPY_MODEL_4df15c7620a24f49b3aa3378c647efa6","value":" 440M/440M [00:01&lt;00:00, 264MB/s]"}},"e5fa02b1a81f4d9f89272c8525123d6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d53ffceb65424876895385320663e88b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5780f994c4474aa3b06c17e419d208d7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"43b8daaf33b94117a4354d6c0a4b5f6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"56044075635844c2a0b93f687b84f96a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2710e0d776734079b0cf828cfbda942e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4df15c7620a24f49b3aa3378c647efa6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9dad98281cd74fc7bdd209d331da2a41":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f68212c1448f4f819fcb69bc57ef9aee","IPY_MODEL_360a6181fa944b33aeace5608eebad2e","IPY_MODEL_8a9e11f058fc433b87d2bf06b3373062"],"layout":"IPY_MODEL_f9948ba7c5c14df09b860fc1c4713909"}},"f68212c1448f4f819fcb69bc57ef9aee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e5664399294540a28e6f19abcaf0da66","placeholder":"​","style":"IPY_MODEL_7069d15537f74a1f91ed7edf90517ef6","value":"tokenizer_config.json: 100%"}},"360a6181fa944b33aeace5608eebad2e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_57a39ad1ee1a43939a25372c5b78fa2c","max":48,"min":0,"orientation":"horizontal","style":"IPY_MODEL_737087fd36cf40f6a972de07b1e2ce9c","value":48}},"8a9e11f058fc433b87d2bf06b3373062":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_65098909f1544415b709f1e1c3ec5fa2","placeholder":"​","style":"IPY_MODEL_1692dd8833434d249639b1a6aa076256","value":" 48.0/48.0 [00:00&lt;00:00, 2.17kB/s]"}},"f9948ba7c5c14df09b860fc1c4713909":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e5664399294540a28e6f19abcaf0da66":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7069d15537f74a1f91ed7edf90517ef6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"57a39ad1ee1a43939a25372c5b78fa2c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"737087fd36cf40f6a972de07b1e2ce9c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"65098909f1544415b709f1e1c3ec5fa2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1692dd8833434d249639b1a6aa076256":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05a8a83c43b44661a4ffa57262462ee4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4bbeb7da72ab456ca1c31021150c94df","IPY_MODEL_822b2d48d04f4e1caec01f515c95396d","IPY_MODEL_c807bef711e44d2ebec92937ad429699"],"layout":"IPY_MODEL_1b0e7eff66e24305b7be6fd69c8e1e39"}},"4bbeb7da72ab456ca1c31021150c94df":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6db928353faf4edf88e5799de40f45e4","placeholder":"​","style":"IPY_MODEL_928514c1d0a14b5aa7306004dd180647","value":"vocab.txt: 100%"}},"822b2d48d04f4e1caec01f515c95396d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d7d52699ac8404491a0c05a42c9a042","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5b6c5ece2f864c90977fb0a53a3796b7","value":231508}},"c807bef711e44d2ebec92937ad429699":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2d8d8659fca5476cbeecf999d9b9ed8a","placeholder":"​","style":"IPY_MODEL_f7b7108da2ee4f8b9c8fa60d0250b61c","value":" 232k/232k [00:00&lt;00:00, 2.93MB/s]"}},"1b0e7eff66e24305b7be6fd69c8e1e39":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6db928353faf4edf88e5799de40f45e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"928514c1d0a14b5aa7306004dd180647":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0d7d52699ac8404491a0c05a42c9a042":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b6c5ece2f864c90977fb0a53a3796b7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2d8d8659fca5476cbeecf999d9b9ed8a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7b7108da2ee4f8b9c8fa60d0250b61c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4844d52bedb74800a045c3241a9f970a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5d5c733e03244c15a24389dbe5dbc852","IPY_MODEL_11800f2e0ec3486784a2873533b7b620","IPY_MODEL_c43f8a4257d546159da0037a0a392436"],"layout":"IPY_MODEL_78558667b0664978aa3f665e155b3d1f"}},"5d5c733e03244c15a24389dbe5dbc852":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_166e355e049d4fa7b1cbfc024570bc67","placeholder":"​","style":"IPY_MODEL_da2084e13e9749a5ad8f832d7e08191e","value":"tokenizer.json: 100%"}},"11800f2e0ec3486784a2873533b7b620":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7dcc7bf5f9d342628c4676503f1ae2c0","max":466062,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e7f7e1cf834842c8bbe88b73d83b5d56","value":466062}},"c43f8a4257d546159da0037a0a392436":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d62557a475864b748272f8f707686c52","placeholder":"​","style":"IPY_MODEL_3fb3b01beffa4f1a839b33a7bcf728e1","value":" 466k/466k [00:00&lt;00:00, 6.47MB/s]"}},"78558667b0664978aa3f665e155b3d1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"166e355e049d4fa7b1cbfc024570bc67":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"da2084e13e9749a5ad8f832d7e08191e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7dcc7bf5f9d342628c4676503f1ae2c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e7f7e1cf834842c8bbe88b73d83b5d56":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d62557a475864b748272f8f707686c52":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3fb3b01beffa4f1a839b33a7bcf728e1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a7c943b5820b46a888c8d31f2e48ae9c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4f0c35f719984a11bf5d016943f125f6","IPY_MODEL_9dedf67f92f541e2a16c5632de1382ff","IPY_MODEL_1139706d76da45f7866a00a67a6ed0e6"],"layout":"IPY_MODEL_2b8266688c234fa4962895e67f77b972"}},"4f0c35f719984a11bf5d016943f125f6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_57179d8cab3c4174a69b89af9db7b56f","placeholder":"​","style":"IPY_MODEL_9fcd20b073b34a5abb11b97407b4c279","value":"100%"}},"9dedf67f92f541e2a16c5632de1382ff":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_cf49aaa1a9cc4efd87f17452cccc288b","max":2060,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5aa54baa319e410586799a4ed881c5be","value":2060}},"1139706d76da45f7866a00a67a6ed0e6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5488a3864f074c7fad823c9852ba3b00","placeholder":"​","style":"IPY_MODEL_f03ad25188a64f39aecb3d769e80acc8","value":" 2060/2060 [05:13&lt;00:00,  9.20it/s]"}},"2b8266688c234fa4962895e67f77b972":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57179d8cab3c4174a69b89af9db7b56f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9fcd20b073b34a5abb11b97407b4c279":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cf49aaa1a9cc4efd87f17452cccc288b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5aa54baa319e410586799a4ed881c5be":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5488a3864f074c7fad823c9852ba3b00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f03ad25188a64f39aecb3d769e80acc8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"367bc89cb40b4abbab274666687acaf1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_570300823b344ef2ac3f37f77a11464a","IPY_MODEL_dbfcd1b691df449e8641b7705adbaddf","IPY_MODEL_9785ded16203492eb69dc7504b9f1842"],"layout":"IPY_MODEL_408f46fb0f20419a8886b87585a63335"}},"570300823b344ef2ac3f37f77a11464a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d6b485c3f0f04c46a784c6992f874838","placeholder":"​","style":"IPY_MODEL_3cddb9e949e34669ba20c8f40edafd43","value":"100%"}},"dbfcd1b691df449e8641b7705adbaddf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_520e80f477c643a4b0673df84df641ca","max":2060,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f362c26cedb745cca7976478d6f839d1","value":2060}},"9785ded16203492eb69dc7504b9f1842":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92d42bd94044484b8355ec56a3e6ad1f","placeholder":"​","style":"IPY_MODEL_fe36ddb7b84e444a918f6b1672b707d7","value":" 2060/2060 [04:34&lt;00:00,  8.44it/s]"}},"408f46fb0f20419a8886b87585a63335":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d6b485c3f0f04c46a784c6992f874838":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3cddb9e949e34669ba20c8f40edafd43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"520e80f477c643a4b0673df84df641ca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f362c26cedb745cca7976478d6f839d1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"92d42bd94044484b8355ec56a3e6ad1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe36ddb7b84e444a918f6b1672b707d7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install transformers"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"agMFVaR8s7kL","executionInfo":{"status":"ok","timestamp":1744389264850,"user_tz":-180,"elapsed":2919,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"a4741930-160a-496a-ccb6-1ef40af9f11d"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.11/dist-packages (4.50.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from transformers) (3.18.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.26.0 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.30.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from transformers) (2.0.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from transformers) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from transformers) (6.0.2)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.11/dist-packages (from transformers) (2024.11.6)\n","Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from transformers) (2.32.3)\n","Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.21.1)\n","Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.5.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.11/dist-packages (from transformers) (4.67.1)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0,>=0.26.0->transformers) (2025.3.2)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0,>=0.26.0->transformers) (4.13.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (3.4.1)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (2.3.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (2025.1.31)\n"]}]},{"cell_type":"code","execution_count":2,"metadata":{"id":"etXwSbYk97pU","executionInfo":{"status":"ok","timestamp":1744389305226,"user_tz":-180,"elapsed":15242,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from transformers import BertModel, BertTokenizer\n","from sklearn.metrics.pairwise import cosine_similarity\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.decomposition import TruncatedSVD\n","import re\n","from tqdm.auto import tqdm"]},{"cell_type":"code","source":["df = pd.read_csv(\"/content/cleaned_book_details (2).csv\")"],"metadata":{"id":"2mO8KmBKtyhF","executionInfo":{"status":"ok","timestamp":1744389451827,"user_tz":-180,"elapsed":148,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["model = BertModel.from_pretrained('bert-base-uncased')"],"metadata":{"id":"PncL-akNt3Gi","colab":{"base_uri":"https://localhost:8080/","height":244,"referenced_widgets":["6a8285b2da7649a996140a2a8513c742","15fed065a0c24116a959ebdd9b16e755","219825d73e0e48c0897c8f6b66d03a30","6ebdf1784e03417b93437e200df65cdb","71d160cfa40c461e8a5f3f6f64bdea74","29a0d99712b64291aab997cc22e72786","07b3960695224d29bea0c71533b226b7","71eb9c44059548889ccf6e7b2772cc05","bf75bbe5eb764fa4a3338d695af4e229","91db10e7d2f84595acca2f03b6d13f32","5276748d5ada45dabc8cfea5757cdc77","903851f6f363442fbfeb8168be8770fb","48c4e03b1c2147c58bebe4ed9ee43f6c","0f8e8eb0e6b548dab6e51dcc7ad79b17","7fc0ff81485741299593725757a4a3ee","e5fa02b1a81f4d9f89272c8525123d6b","d53ffceb65424876895385320663e88b","5780f994c4474aa3b06c17e419d208d7","43b8daaf33b94117a4354d6c0a4b5f6b","56044075635844c2a0b93f687b84f96a","2710e0d776734079b0cf828cfbda942e","4df15c7620a24f49b3aa3378c647efa6"]},"executionInfo":{"status":"ok","timestamp":1744389487936,"user_tz":-180,"elapsed":3048,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"72ccb142-8494-45b2-e2d5-a37f81ee0fa3"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6a8285b2da7649a996140a2a8513c742"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`\n","WARNING:huggingface_hub.file_download:Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`\n"]},{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/440M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"903851f6f363442fbfeb8168be8770fb"}},"metadata":{}}]},{"cell_type":"code","source":["tokenizer = BertTokenizer.from_pretrained(\"bert-base-uncased\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["9dad98281cd74fc7bdd209d331da2a41","f68212c1448f4f819fcb69bc57ef9aee","360a6181fa944b33aeace5608eebad2e","8a9e11f058fc433b87d2bf06b3373062","f9948ba7c5c14df09b860fc1c4713909","e5664399294540a28e6f19abcaf0da66","7069d15537f74a1f91ed7edf90517ef6","57a39ad1ee1a43939a25372c5b78fa2c","737087fd36cf40f6a972de07b1e2ce9c","65098909f1544415b709f1e1c3ec5fa2","1692dd8833434d249639b1a6aa076256","05a8a83c43b44661a4ffa57262462ee4","4bbeb7da72ab456ca1c31021150c94df","822b2d48d04f4e1caec01f515c95396d","c807bef711e44d2ebec92937ad429699","1b0e7eff66e24305b7be6fd69c8e1e39","6db928353faf4edf88e5799de40f45e4","928514c1d0a14b5aa7306004dd180647","0d7d52699ac8404491a0c05a42c9a042","5b6c5ece2f864c90977fb0a53a3796b7","2d8d8659fca5476cbeecf999d9b9ed8a","f7b7108da2ee4f8b9c8fa60d0250b61c","4844d52bedb74800a045c3241a9f970a","5d5c733e03244c15a24389dbe5dbc852","11800f2e0ec3486784a2873533b7b620","c43f8a4257d546159da0037a0a392436","78558667b0664978aa3f665e155b3d1f","166e355e049d4fa7b1cbfc024570bc67","da2084e13e9749a5ad8f832d7e08191e","7dcc7bf5f9d342628c4676503f1ae2c0","e7f7e1cf834842c8bbe88b73d83b5d56","d62557a475864b748272f8f707686c52","3fb3b01beffa4f1a839b33a7bcf728e1"]},"id":"m99H6CiwueJz","executionInfo":{"status":"ok","timestamp":1744389675310,"user_tz":-180,"elapsed":1300,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"31764742-3bf1-4265-f01e-e53c670352ea"},"execution_count":9,"outputs":[{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/48.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9dad98281cd74fc7bdd209d331da2a41"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"05a8a83c43b44661a4ffa57262462ee4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/466k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4844d52bedb74800a045c3241a9f970a"}},"metadata":{}}]},{"cell_type":"code","source":["import torch"],"metadata":{"id":"2b8FJPhEvZdW","executionInfo":{"status":"ok","timestamp":1744389910109,"user_tz":-180,"elapsed":5,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","model.to(device)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gxxJBqgKvX4h","executionInfo":{"status":"ok","timestamp":1744389911881,"user_tz":-180,"elapsed":480,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"478a2f88-cfd4-498e-8409-5ea1add81e73"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["BertModel(\n","  (embeddings): BertEmbeddings(\n","    (word_embeddings): Embedding(30522, 768, padding_idx=0)\n","    (position_embeddings): Embedding(512, 768)\n","    (token_type_embeddings): Embedding(2, 768)\n","    (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","    (dropout): Dropout(p=0.1, inplace=False)\n","  )\n","  (encoder): BertEncoder(\n","    (layer): ModuleList(\n","      (0-11): 12 x BertLayer(\n","        (attention): BertAttention(\n","          (self): BertSdpaSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","          (output): BertSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (intermediate): BertIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","          (intermediate_act_fn): GELUActivation()\n","        )\n","        (output): BertOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","    )\n","  )\n","  (pooler): BertPooler(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (activation): Tanh()\n","  )\n",")"]},"metadata":{},"execution_count":12}]},{"cell_type":"markdown","source":["# AVERAGING"],"metadata":{"id":"DwV-HqfaeBi-"}},{"cell_type":"code","source":["def combine_features(row):\n","    return f\"{row['description']} {row['plot']}\"\n","\n","df['combined_text'] = df.apply(combine_features, axis=1)\n","df['combined_text'] = df['combined_text'].fillna('').apply(lambda x: re.sub(r'\\s+', ' ', x))"],"metadata":{"id":"kLCdpLv6t4-C","executionInfo":{"status":"ok","timestamp":1744389973328,"user_tz":-180,"elapsed":1427,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["def split_text(text, chunk_size=400, overlap=50):\n","    \"\"\"Разбивает текст на перекрывающиеся фрагменты\"\"\"\n","    tokens = tokenizer.tokenize(text)\n","    chunks = []\n","    for i in range(0, len(tokens), chunk_size - overlap):\n","        chunk_tokens = tokens[i:i + chunk_size]\n","        chunk_text = tokenizer.convert_tokens_to_string(chunk_tokens)\n","        chunks.append(chunk_text)\n","    return chunks"],"metadata":{"id":"luYGFqX7t6e5","executionInfo":{"status":"ok","timestamp":1744390074894,"user_tz":-180,"elapsed":7,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["def get_average_embedding(text, model, chunk_size=400, overlap=50):\n","    \"\"\"Генерирует усредненный эмбеддинг для длинного текста\"\"\"\n","    if not isinstance(text, str) or len(tokenizer.tokenize(text)) < 20:\n","        return np.zeros((768,))\n","\n","    chunks = split_text(text, chunk_size, overlap)\n","    embeddings_list = []\n","    for chunk in chunks:\n","        inputs = tokenizer(chunk, return_tensors=\"pt\").to(device)\n","        outputs = model(**inputs)\n","        last_hidden_states = outputs.last_hidden_state.cpu().detach().numpy()\n","        cls_token_embedding = last_hidden_states[:, 0, :]\n","        embeddings_list.append(cls_token_embedding)\n","\n","    average_embedding = np.mean(np.concatenate(embeddings_list), axis=0)\n","    return average_embedding"],"metadata":{"id":"pwsYhJvOt7_T","executionInfo":{"status":"ok","timestamp":1744390076392,"user_tz":-180,"elapsed":7,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["tqdm.pandas()\n","\n","df['avg_embedding'] = df['combined_text'].progress_apply(\n","    lambda x: get_average_embedding(x, model))"],"metadata":{"id":"391Cu4v1t9a7","colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["a7c943b5820b46a888c8d31f2e48ae9c","4f0c35f719984a11bf5d016943f125f6","9dedf67f92f541e2a16c5632de1382ff","1139706d76da45f7866a00a67a6ed0e6","2b8266688c234fa4962895e67f77b972","57179d8cab3c4174a69b89af9db7b56f","9fcd20b073b34a5abb11b97407b4c279","cf49aaa1a9cc4efd87f17452cccc288b","5aa54baa319e410586799a4ed881c5be","5488a3864f074c7fad823c9852ba3b00","f03ad25188a64f39aecb3d769e80acc8"]},"executionInfo":{"status":"ok","timestamp":1744390393583,"user_tz":-180,"elapsed":313962,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"f74655be-cc57-4cfb-aece-690ca6d6fcfc"},"execution_count":19,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2060 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a7c943b5820b46a888c8d31f2e48ae9c"}},"metadata":{}}]},{"cell_type":"code","source":["def get_book_recommendations(query, top_k=3):\n","    encoded_input = tokenizer(query, return_tensors='pt').to(device)\n","    output = model(**encoded_input)\n","    query_embedding = output.last_hidden_state\n","\n","    query_embedding = query_embedding.squeeze(dim=0).detach().cpu().numpy()\n","\n","    similarities = cosine_similarity(\n","        query_embedding,\n","        np.vstack(df['avg_embedding'])\n","    )[0]\n","\n","    top_indices = np.argsort(similarities)[-top_k:][::-1]\n","\n","    return df.iloc[top_indices][['book_name', 'author', 'genre']].assign(\n","        similarity_score=[f\"{sim:.4f}\" for sim in similarities[top_indices]]\n","    )"],"metadata":{"id":"t1YjNNb51Dli","executionInfo":{"status":"ok","timestamp":1744391743476,"user_tz":-180,"elapsed":9,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":76,"outputs":[]},{"cell_type":"code","source":["user_query = \"A young wizard discovers his magical heritage and attends a school of magic while facing a dark lord\"\n","recommendations = get_book_recommendations(user_query)\n","print(recommendations[['book_name', 'author', 'genre', 'similarity_score']])"],"metadata":{"id":"PdCoZk44uA_o","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1744391744573,"user_tz":-180,"elapsed":129,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"514ca04a-0d21-4775-ef23-70c4ac6efd5a"},"execution_count":77,"outputs":[{"output_type":"stream","name":"stdout","text":["                        book_name            author              genre  \\\n","1565  The Search for the Dice Man    Luke Rhinehart              Novel   \n","528           The Duke's Children  Anthony Trollope  Family-saga novel   \n","1586        Servants of the Wankh        Jack Vance    Science fiction   \n","\n","     similarity_score  \n","1565           0.8241  \n","528            0.8152  \n","1586           0.8093  \n"]}]},{"cell_type":"code","source":["df.to_csv(\"embeddings_bert_averaging.csv\", index=False)"],"metadata":{"id":"Dtqld74FuFrP","executionInfo":{"status":"ok","timestamp":1744391850555,"user_tz":-180,"elapsed":10157,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":78,"outputs":[]},{"cell_type":"markdown","source":["# JUST PLOT"],"metadata":{"id":"dAXO8SDGeFwY"}},{"cell_type":"code","source":["def split_text(text, chunk_size=400, overlap=50):\n","    \"\"\"Разбивает текст на перекрывающиеся фрагменты\"\"\"\n","    tokens = tokenizer.tokenize(text)\n","    chunks = []\n","    for i in range(0, len(tokens), chunk_size - overlap):\n","        chunk_tokens = tokens[i:i + chunk_size]\n","        chunk_text = tokenizer.convert_tokens_to_string(chunk_tokens)\n","        chunks.append(chunk_text)\n","    return chunks"],"metadata":{"id":"2HsaDfoteV-u","executionInfo":{"status":"ok","timestamp":1744392044466,"user_tz":-180,"elapsed":12,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":79,"outputs":[]},{"cell_type":"code","source":["def get_average_embedding(text, model, chunk_size=400, overlap=50):\n","    \"\"\"Генерирует усредненный эмбеддинг для длинного текста\"\"\"\n","    if not isinstance(text, str) or len(tokenizer.tokenize(text)) < 20:\n","        return np.zeros((768,))\n","\n","    chunks = split_text(text, chunk_size, overlap)\n","    embeddings_list = []\n","    for chunk in chunks:\n","        inputs = tokenizer(chunk, return_tensors=\"pt\").to(device)\n","        outputs = model(**inputs)\n","        last_hidden_states = outputs.last_hidden_state.cpu().detach().numpy()\n","        cls_token_embedding = last_hidden_states[:, 0, :]\n","        embeddings_list.append(cls_token_embedding)\n","\n","    average_embedding = np.mean(np.concatenate(embeddings_list), axis=0)\n","    return average_embedding"],"metadata":{"id":"_CPz3O80eZjo","executionInfo":{"status":"ok","timestamp":1744392047004,"user_tz":-180,"elapsed":11,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":80,"outputs":[]},{"cell_type":"code","source":["tqdm.pandas()\n","\n","df['avg_embedding'] = df['plot'].progress_apply(\n","    lambda x: get_average_embedding(x, model))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["367bc89cb40b4abbab274666687acaf1","570300823b344ef2ac3f37f77a11464a","dbfcd1b691df449e8641b7705adbaddf","9785ded16203492eb69dc7504b9f1842","408f46fb0f20419a8886b87585a63335","d6b485c3f0f04c46a784c6992f874838","3cddb9e949e34669ba20c8f40edafd43","520e80f477c643a4b0673df84df641ca","f362c26cedb745cca7976478d6f839d1","92d42bd94044484b8355ec56a3e6ad1f","fe36ddb7b84e444a918f6b1672b707d7"]},"id":"fKibQV1gebn8","executionInfo":{"status":"ok","timestamp":1744392323444,"user_tz":-180,"elapsed":274634,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"3f221e45-83f1-4319-9a70-b2554fc25848"},"execution_count":81,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/2060 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"367bc89cb40b4abbab274666687acaf1"}},"metadata":{}}]},{"cell_type":"code","source":["def get_book_recommendations(query, top_k=3):\n","    encoded_input = tokenizer(query, return_tensors='pt').to(device)\n","    output = model(**encoded_input)\n","    query_embedding = output.last_hidden_state\n","\n","    query_embedding = query_embedding.squeeze(dim=0).detach().cpu().numpy()\n","\n","    similarities = cosine_similarity(\n","        query_embedding,\n","        np.vstack(df['avg_embedding'])\n","    )[0]\n","\n","    top_indices = np.argsort(similarities)[-top_k:][::-1]\n","\n","    return df.iloc[top_indices][['book_name', 'author', 'genre']].assign(\n","        similarity_score=[f\"{sim:.4f}\" for sim in similarities[top_indices]]\n","    )"],"metadata":{"id":"8SL_1ojjedpF","executionInfo":{"status":"ok","timestamp":1744392323503,"user_tz":-180,"elapsed":6,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":82,"outputs":[]},{"cell_type":"code","source":["user_query = \"A young wizard discovers his magical heritage and attends a school of magic while facing a dark lord\"\n","recommendations = get_book_recommendations(user_query)\n","print(recommendations[['book_name', 'author', 'genre', 'similarity_score']])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TlXwJWyyefkj","executionInfo":{"status":"ok","timestamp":1744392323513,"user_tz":-180,"elapsed":12,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}},"outputId":"492aef4a-e92f-4e73-cd68-2bf10aba9de6"},"execution_count":83,"outputs":[{"output_type":"stream","name":"stdout","text":["                       book_name               author  \\\n","429                 The Darkling      David Kesterton   \n","200   Blue Moon (Hamilton novel)  Laurell K. Hamilton   \n","1728   The Swimming-Pool Library    Alan Hollinghurst   \n","\n","                              genre similarity_score  \n","429                         Fantasy           0.8710  \n","200   Horror, Mystery, Erotic novel           0.8589  \n","1728                            NaN           0.8455  \n"]}]},{"cell_type":"code","source":["df.to_csv(\"embeddings_bert_just_plot.csv\", index=False)"],"metadata":{"id":"nkoYutrTe92Q","executionInfo":{"status":"ok","timestamp":1744392348742,"user_tz":-180,"elapsed":10173,"user":{"displayName":"Alina Mazoruk","userId":"05828642368613234013"}}},"execution_count":84,"outputs":[]}]}